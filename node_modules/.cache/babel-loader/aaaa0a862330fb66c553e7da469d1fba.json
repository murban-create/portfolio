{"ast":null,"code":"import React from 'react';\nimport color from 'tinycolor2';\nimport format from 'date-fns/format';\nimport getDay from 'date-fns/getDay';\nimport getYear from 'date-fns/getYear';\nimport parseISO from 'date-fns/parseISO';\nimport differenceInCalendarDays from 'date-fns/differenceInCalendarDays';\nimport eachDayOfInterval from 'date-fns/eachDayOfInterval';\nimport formatISO from 'date-fns/formatISO';\nimport getMonth from 'date-fns/getMonth';\nimport nextDay from 'date-fns/nextDay';\nimport subWeeks from 'date-fns/subWeeks';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\nvar css_248z = \".styles_calendar__1s6ps {\\n  display: block;\\n  max-width: 100%;\\n  height: auto;\\n  overflow: visible;\\n}\\n\\n.styles_calendar__1s6ps text {\\n  fill: currentColor;\\n}\\n\\n.styles_block__1oBAV {\\n  stroke: rgba(0, 0, 0, 0.1);\\n  stroke-width: 1px;\\n  shape-rendering: geometricPrecision;\\n}\\n\\n.styles_footer__56qQv {\\n  display: flex;\\n}\\n\\n.styles_legendColors__1wUi_ {\\n  margin-left: auto;\\n  display: flex;\\n  align-items: center;\\n  gap: 0.2em;\\n}\\n\\n/*noinspection CssUnresolvedCustomProperty*/\\n@keyframes styles_loadingAnimation__1DJJ8 {\\n  0% {\\n    fill: var(--react-activity-calendar-loading);\\n  }\\n  50% {\\n    fill: var(--react-activity-calendar-loading-active);\\n  }\\n  100% {\\n    fill: var(--react-activity-calendar-loading);\\n  }\\n}\\n\";\nvar styles = {\n  \"calendar\": \"styles_calendar__1s6ps\",\n  \"block\": \"styles_block__1oBAV\",\n  \"footer\": \"styles_footer__56qQv\",\n  \"legendColors\": \"styles_legendColors__1wUi_\",\n  \"loadingAnimation\": \"styles_loadingAnimation__1DJJ8\"\n};\nstyleInject(css_248z);\nconst NAMESPACE = 'react-activity-calendar';\nconst MIN_DISTANCE_MONTH_LABELS = 2;\nconst DEFAULT_THEME = createCalendarTheme('#042a33');\nfunction groupByWeeks(days) {\n  let weekStart = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  if (days.length === 0) {\n    return [];\n  } // The calendar expects a continuous sequence of days, so fill gaps with empty activity.\n\n  const normalizedDays = normalizeCalendarDays(days); // Determine the first date of the calendar. If the first contribution date is not\n  // specified week day the desired day one week earlier will be selected.\n\n  const firstDate = parseISO(normalizedDays[0].date);\n  const firstCalendarDate = getDay(firstDate) === weekStart ? firstDate : subWeeks(nextDay(firstDate, weekStart), 1); // In order to correctly group contributions by week it is necessary to left pad the list,\n  // because the first date might not be desired week day.\n\n  const paddedDays = [...Array(differenceInCalendarDays(firstDate, firstCalendarDate)).fill(undefined), ...normalizedDays];\n  return Array(Math.ceil(paddedDays.length / 7)).fill(undefined).map((_, calendarWeek) => paddedDays.slice(calendarWeek * 7, calendarWeek * 7 + 7));\n}\nfunction normalizeCalendarDays(days) {\n  const daysMap = days.reduce((map, day) => {\n    map.set(day.date, day);\n    return map;\n  }, new Map());\n  return eachDayOfInterval({\n    start: parseISO(days[0].date),\n    end: parseISO(days[days.length - 1].date)\n  }).map(day => {\n    const date = formatISO(day, {\n      representation: 'date'\n    });\n    if (daysMap.has(date)) {\n      return daysMap.get(date);\n    }\n    return {\n      date,\n      count: 0,\n      level: 0\n    };\n  });\n}\nfunction getMonthLabels(weeks) {\n  let monthNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_MONTH_LABELS;\n  return weeks.reduce((labels, week, index) => {\n    const firstWeekDay = week.find(day => day !== undefined);\n    if (!firstWeekDay) {\n      throw new Error(`Unexpected error: Week is empty: [${week}]`);\n    }\n    const month = monthNames[getMonth(parseISO(firstWeekDay.date))];\n    const prev = labels[labels.length - 1];\n    if (index === 0 || prev.text !== month) {\n      return [...labels, {\n        x: index,\n        y: 0,\n        text: month\n      }];\n    }\n    return labels;\n  }, []).filter((label, index, labels) => {\n    if (index === 0) {\n      return labels[1] && labels[1].x - label.x > MIN_DISTANCE_MONTH_LABELS;\n    }\n    return true;\n  });\n}\nfunction createCalendarTheme(baseColor) {\n  let emptyColor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : color('white').darken(8).toHslString();\n  const base = color(baseColor);\n  if (!base.isValid()) {\n    return DEFAULT_THEME;\n  }\n  return {\n    level4: base.setAlpha(0.92).toHslString(),\n    level3: base.setAlpha(0.76).toHslString(),\n    level2: base.setAlpha(0.6).toHslString(),\n    level1: base.setAlpha(0.44).toHslString(),\n    level0: emptyColor\n  };\n}\nfunction getTheme(theme, color) {\n  if (theme) {\n    return Object.assign({}, DEFAULT_THEME, theme);\n  }\n  if (color) {\n    return createCalendarTheme(color);\n  }\n  return DEFAULT_THEME;\n}\nfunction getClassName(name, styles) {\n  if (styles) {\n    return `${NAMESPACE}__${name} ${styles}`;\n  }\n  return `${NAMESPACE}__${name}`;\n}\nfunction generateEmptyData() {\n  const year = new Date().getFullYear();\n  const days = eachDayOfInterval({\n    start: new Date(year, 0, 1),\n    end: new Date(year, 11, 31)\n  });\n  return days.map(date => ({\n    date: formatISO(date, {\n      representation: 'date'\n    }),\n    count: 0,\n    level: 0\n  }));\n}\nconst DEFAULT_MONTH_LABELS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\nconst DEFAULT_WEEKDAY_LABELS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\nconst DEFAULT_LABELS = {\n  months: DEFAULT_MONTH_LABELS,\n  weekdays: DEFAULT_WEEKDAY_LABELS,\n  totalCount: '{{count}} contributions in {{year}}',\n  legend: {\n    less: 'Less',\n    more: 'More'\n  }\n};\nconst ActivityCalendar = _ref => {\n  var _data$;\n  let {\n    data,\n    blockMargin = 4,\n    blockRadius = 2,\n    blockSize = 12,\n    children,\n    color: color$1 = undefined,\n    dateFormat = 'MMM do, yyyy',\n    eventHandlers = {},\n    fontSize = 14,\n    hideColorLegend = false,\n    hideMonthLabels = false,\n    hideTotalCount = false,\n    labels: labelsProp,\n    loading = false,\n    showWeekdayLabels = false,\n    style = {},\n    theme: themeProp,\n    weekStart = 0 // Sunday\n  } = _ref;\n  if (loading) {\n    data = generateEmptyData();\n  }\n  if (data.length === 0) {\n    return null;\n  }\n  const weeks = groupByWeeks(data, weekStart);\n  const totalCount = data.reduce((sum, day) => sum + day.count, 0);\n  const year = getYear(parseISO((_data$ = data[0]) === null || _data$ === void 0 ? void 0 : _data$.date));\n  const theme = getTheme(themeProp, color$1);\n  const labels = Object.assign({}, DEFAULT_LABELS, labelsProp);\n  const textHeight = hideMonthLabels ? 0 : fontSize + 2 * blockMargin;\n  function getDimensions() {\n    return {\n      width: weeks.length * (blockSize + blockMargin) - blockMargin,\n      height: textHeight + (blockSize + blockMargin) * 7 - blockMargin\n    };\n  }\n  function getTooltipMessage(contribution) {\n    const date = format(parseISO(contribution.date), dateFormat);\n    return `<strong>${contribution.count} contributions</strong> on ${date}`;\n  }\n  function getEventHandlers(data) {\n    return Object.keys(eventHandlers).reduce((handlers, key) => ({\n      ...handlers,\n      [key]: event => {\n        var _eventHandlers$key;\n        return (_eventHandlers$key = eventHandlers[key]) === null || _eventHandlers$key === void 0 ? void 0 : _eventHandlers$key.call(eventHandlers, event)(data);\n      }\n    }), {});\n  }\n  function renderLabels() {\n    const style = {\n      fontSize\n    };\n    if (!showWeekdayLabels && hideMonthLabels) {\n      return null;\n    }\n    return /*#__PURE__*/React.createElement(React.Fragment, null, showWeekdayLabels && /*#__PURE__*/React.createElement(\"g\", {\n      className: getClassName('legend-weekday'),\n      style: style\n    }, weeks[1].map((day, y) => {\n      if (!day || y % 2 === 0) {\n        return null;\n      }\n      const dayIndex = getDay(parseISO(day.date));\n      return /*#__PURE__*/React.createElement(\"text\", {\n        x: -2 * blockMargin,\n        y: textHeight + (fontSize / 2 + blockMargin) + (blockSize + blockMargin) * y,\n        textAnchor: \"end\",\n        key: day.date\n      }, labels.weekdays ? labels.weekdays[dayIndex] : DEFAULT_WEEKDAY_LABELS[dayIndex]);\n    })), !hideMonthLabels && /*#__PURE__*/React.createElement(\"g\", {\n      className: getClassName('legend-month'),\n      style: style\n    }, getMonthLabels(weeks, labels.months).map((_ref2, index, labels) => {\n      let {\n        text,\n        x\n      } = _ref2;\n\n      // Skip the first month label if there's not enough space to the next one\n      if (index === 0 && labels[1] && labels[1].x - x <= MIN_DISTANCE_MONTH_LABELS) {\n        return null;\n      }\n      return /*#__PURE__*/React.createElement(\"text\", {\n        x: (blockSize + blockMargin) * x,\n        alignmentBaseline: \"hanging\",\n        key: x\n      }, text);\n    })));\n  }\n  function renderBlocks() {\n    return weeks.map((week, weekIndex) => week.map((day, dayIndex) => {\n      if (!day) {\n        return null;\n      }\n      const style = loading ? {\n        animation: `${styles.loadingAnimation} 1.5s ease-in-out infinite`,\n        animationDelay: `${weekIndex * 20 + dayIndex * 20}ms`\n      } : undefined;\n      return /*#__PURE__*/React.createElement(\"rect\", _extends({}, getEventHandlers(day), {\n        x: 0,\n        y: textHeight + (blockSize + blockMargin) * dayIndex,\n        width: blockSize,\n        height: blockSize,\n        fill: theme[`level${day.level}`],\n        rx: blockRadius,\n        ry: blockRadius,\n        className: styles.block,\n        \"data-date\": day.date,\n        \"data-tip\": children ? getTooltipMessage(day) : undefined,\n        key: day.date,\n        style: style\n      }));\n    })).map((week, x) => /*#__PURE__*/React.createElement(\"g\", {\n      key: x,\n      transform: `translate(${(blockSize + blockMargin) * x}, 0)`\n    }, week));\n  }\n  function renderFooter() {\n    var _labels$legend, _labels$legend2;\n    var _labels$legend$less, _labels$legend$more;\n    if (hideTotalCount && hideColorLegend) {\n      return null;\n    }\n    return /*#__PURE__*/React.createElement(\"footer\", {\n      className: getClassName('footer', styles.footer),\n      style: {\n        marginTop: 2 * blockMargin,\n        fontSize\n      }\n    }, loading && /*#__PURE__*/React.createElement(\"div\", null, \"\\xA0\"), !loading && !hideTotalCount && /*#__PURE__*/React.createElement(\"div\", {\n      className: getClassName('count')\n    }, labels.totalCount ? labels.totalCount.replace('{{count}}', String(totalCount)).replace('{{year}}', String(year)) : `${totalCount} contributions in ${year}`), !loading && !hideColorLegend && /*#__PURE__*/React.createElement(\"div\", {\n      className: getClassName('legend-colors', styles.legendColors)\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        marginRight: '0.4em'\n      }\n    }, (_labels$legend$less = labels === null || labels === void 0 ? void 0 : (_labels$legend = labels.legend) === null || _labels$legend === void 0 ? void 0 : _labels$legend.less) !== null && _labels$legend$less !== void 0 ? _labels$legend$less : 'Less'), Array(5).fill(undefined).map((_, index) => /*#__PURE__*/React.createElement(\"svg\", {\n      width: blockSize,\n      height: blockSize,\n      key: index\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      width: blockSize,\n      height: blockSize,\n      fill: theme[`level${index}`],\n      rx: blockRadius,\n      ry: blockRadius\n    }))), /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        marginLeft: '0.4em'\n      }\n    }, (_labels$legend$more = labels === null || labels === void 0 ? void 0 : (_labels$legend2 = labels.legend) === null || _labels$legend2 === void 0 ? void 0 : _labels$legend2.more) !== null && _labels$legend$more !== void 0 ? _labels$legend$more : 'More')));\n  }\n  const {\n    width,\n    height\n  } = getDimensions();\n  const additionalStyles = {\n    maxWidth: width,\n    // Required for correct colors in CSS loading animation\n    [`--${NAMESPACE}-loading`]: theme.level0,\n    [`--${NAMESPACE}-loading-active`]: color(theme.level0).darken(8).toString()\n  };\n  return /*#__PURE__*/React.createElement(\"article\", {\n    className: NAMESPACE,\n    style: {\n      ...style,\n      ...additionalStyles\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: `0 0 ${width} ${height}`,\n    className: getClassName('calendar', styles.calendar)\n  }, !loading && renderLabels(), renderBlocks()), renderFooter(), children);\n};\nconst Skeleton = props => /*#__PURE__*/React.createElement(ActivityCalendar, _extends({\n  data: []\n}, props));\nexport { Skeleton, createCalendarTheme, ActivityCalendar as default };","map":null,"metadata":{},"sourceType":"module"}